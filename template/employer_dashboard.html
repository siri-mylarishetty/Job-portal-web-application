{% extends "base.html" %}
{% block title %}Employer Dashboard{% endblock %}
{% block content %}

<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h3 class="mb-0">Employer Dashboard</h3>
        <p class="text-muted mb-0">{{ employer.company_name }} · {{ employer.contact_email }}</p>
      </div>
      <a href="{{ url_for('post_job') }}" class="btn btn-primary btn-sm">Post New Job</a>
    </div>

    {% for job in jobs %}
    <div class="card card-shadow border-0 mb-3">
      <div class="card-body">
        <h5 class="mb-1">{{ job.title }}</h5>
        <p class="text-muted small mb-2">
          Posted on {{ job.created_at.strftime('%Y-%m-%d') }} · {{ job.location or "Location not specified" }}
        </p>
        <p class="mb-2 text-muted small">
          {{ job.description[:160] }}{% if job.description|length > 160 %}...{% endif %}
        </p>
        <h6 class="mt-3 mb-2">Applicants</h6>
        <ul class="list-group list-group-flush">
          {% set apps = job_applications.get(job.id, []) %}
          {% if apps %}
            {% for appn in apps %}
            <li class="list-group-item px-0">
              <strong>{{ appn.applicant.full_name }}</strong>
              <span class="text-muted small">({{ appn.applicant.email }})</span><br>
              <span class="text-muted small">Applied on {{ appn.applied_at.strftime('%Y-%m-%d') }}</span><br>
              <span class="small">{{ appn.cover_letter[:180] }}{% if appn.cover_letter|length > 180 %}...{% endif %}</span>
            </li>
            {% endfor %}
          {% else %}
            <li class="list-group-item px-0 text-muted small">No applicants yet.</li>
          {% endif %}
        </ul>
      </div>
    </div>
    {% else %}
    <div class="alert alert-info">You have not posted any jobs yet.</div>
    {% endfor %}
  </div>
</div>

{% endblock %}
